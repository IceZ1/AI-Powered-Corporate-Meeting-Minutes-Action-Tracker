name: 🌟 Auto-Star Thank You

on:
  watch:
    types: [started]

jobs:
  thank-you:
    name: 🙏 Thank New Stargazer
    runs-on: ubuntu-latest
    steps:
    - name: 📂 Checkout Code
      uses: actions/checkout@v4

    - name: 🌟 Get Stargazer Info
      id: stargazer
      run: |
        echo "username=${{ github.actor }}" >> $GITHUB_OUTPUT
        echo "star_count=$(curl -s https://api.github.com/repos/${{ github.repository }} | jq .stargazers_count)" >> $GITHUB_OUTPUT

    - name: 💬 Create Thank You Issue
      uses: actions/github-script@v7
      with:
        script: |
          const username = '${{ steps.stargazer.outputs.username }}';
          const starCount = '${{ steps.stargazer.outputs.star_count }}';
          
          const issueBody = `
          ## 🌟 Thank You for Starring CorpMeet-AI!
          
          Hey @${username}! 👋
          
          Thank you so much for starring CorpMeet-AI! ⭐ You're our **${starCount}${getOrdinalSuffix(starCount)}** star! 🎉
          
          ### 🎁 As a token of our appreciation:
          
          - 📧 **Early Access**: You'll be among the first to know about new features
          - 🏷️ **Special Badge**: You're now a recognized supporter in our community
          - 💝 **Exclusive Updates**: Get insider updates on our development progress
          
          ### 🚀 What's Next?
          
          - 🔔 **Watch** this repository to get notified of releases
          - 🤝 **Contribute** by checking out our [Good First Issues](https://github.com/Jani-shiv/AI-Powered-Corporate-Meeting-Minutes-Action-Tracker/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22)
          - 💬 **Join** our [Discord community](https://discord.gg/corpmeet-ai) for real-time discussions
          - 📢 **Share** CorpMeet-AI with your network
          
          ### 💎 Consider Sponsorship
          
          If CorpMeet-AI helps your team save time, consider [sponsoring us](https://github.com/sponsors/Jani-shiv) to help accelerate development!
          
          ---
          
          **Thanks again for your support!** 🙏
          
          *The CorpMeet-AI Team* 💙
          `;
          
          function getOrdinalSuffix(n) {
            const s = ["th", "st", "nd", "rd"];
            const v = n % 100;
            return s[(v - 20) % 10] || s[v] || s[0];
          }
          
          await github.rest.issues.create({
            owner: context.repo.owner,
            repo: context.repo.repo,
            title: `🌟 Thank you @${username} for starring CorpMeet-AI!`,
            body: issueBody,
            labels: ['thank-you', 'community']
          });

    - name: 📊 Update Star Count in README
      if: steps.stargazer.outputs.star_count != ''
      run: |
        # This could update a star count badge or milestone in README
        echo "⭐ Star count: ${{ steps.stargazer.outputs.star_count }}"
        
    - name: 🎉 Check for Milestones
      uses: actions/github-script@v7
      with:
        script: |
          const starCount = parseInt('${{ steps.stargazer.outputs.star_count }}');
          const milestones = [10, 25, 50, 100, 250, 500, 1000, 2500, 5000];
          
          if (milestones.includes(starCount)) {
            const celebrationIssue = `
            ## 🎉 MILESTONE ACHIEVED: ${starCount} STARS! 🌟
            
            We've just reached **${starCount} stars**! 🚀
            
            This is an incredible milestone for CorpMeet-AI and we couldn't have done it without our amazing community! 
            
            ### 🎁 Milestone Celebration
            
            To celebrate this achievement:
            - 🎊 Special announcement in our Discord
            - 📢 Social media celebration
            - 🏆 Recognition for all contributors
            - 🎯 Unlock new development goals
            
            ### 🚀 What This Means
            
            With ${starCount} stars, we're committed to:
            - 🔥 Accelerated feature development
            - 📊 Enhanced AI capabilities  
            - 🌍 Expanded platform support
            - 💼 Enterprise features
            
            **Thank you to everyone who believed in CorpMeet-AI!** 💙
            
            ---
            
            🌟 **Star us** | 🤝 **Contribute** | 💎 **Sponsor** | 📢 **Share**
            `;
            
            await github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: `🎉 MILESTONE: ${starCount} Stars Achieved! 🌟`,
              body: celebrationIssue,
              labels: ['milestone', 'celebration', 'announcement']
            });
          }