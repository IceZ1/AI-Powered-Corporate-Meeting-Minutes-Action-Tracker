{% extends "base.html" %}

{% block title %}Upload Transcript - CorpMeet-AI{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <!-- Page Header -->
        <div class="text-center mb-5">
            <h1 class="display-5 text-primary fw-bold">
                <i class="bi bi-cloud-upload me-3"></i>Upload Meeting Transcript
            </h1>
            <p class="lead text-muted">
                Upload your meeting transcript file or paste the text directly to generate AI-powered meeting minutes
            </p>
        </div>

        <!-- Upload Form -->
        <div class="card shadow-lg border-0">
            <div class="card-header bg-primary text-white">
                <h4 class="card-title mb-0">
                    <i class="bi bi-file-text me-2"></i>Meeting Transcript Input
                </h4>
            </div>
            <div class="card-body p-4">
                <form action="{{ url_for('process_transcript') }}" method="post" enctype="multipart/form-data" id="transcriptForm">
                    <!-- Meeting Title -->
                    <div class="mb-4">
                        <label for="meeting_title" class="form-label fw-bold">
                            <i class="bi bi-tag me-1"></i>Meeting Title
                        </label>
                        <input type="text" class="form-control form-control-lg" id="meeting_title" name="meeting_title" 
                               placeholder="e.g., Weekly Team Standup, Q4 Planning Meeting" required>
                        <div class="form-text">Enter a descriptive title for this meeting</div>
                    </div>

                    <!-- Input Method Tabs -->
                    <ul class="nav nav-tabs mb-4" id="inputTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="paste-tab" data-bs-toggle="tab" data-bs-target="#paste-pane" 
                                    type="button" role="tab" aria-controls="paste-pane" aria-selected="true">
                                <i class="bi bi-clipboard me-1"></i>Paste Text
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="upload-tab" data-bs-toggle="tab" data-bs-target="#upload-pane" 
                                    type="button" role="tab" aria-controls="upload-pane" aria-selected="false">
                                <i class="bi bi-file-earmark-arrow-up me-1"></i>Upload File
                            </button>
                        </li>
                    </ul>

                    <div class="tab-content" id="inputTabsContent">
                        <!-- Paste Text Tab -->
                        <div class="tab-pane fade show active" id="paste-pane" role="tabpanel" aria-labelledby="paste-tab">
                            <div class="mb-4">
                                <label for="transcript_text" class="form-label fw-bold">
                                    <i class="bi bi-textarea-t me-1"></i>Meeting Transcript
                                </label>
                                <textarea class="form-control" id="transcript_text" name="transcript_text" 
                                          rows="12" placeholder="Paste your meeting transcript here...

Example:
Meeting started at 10:00 AM
Attendees: John Smith, Sarah Johnson, Mike Chen

Sarah: Let's start with the project status update...
John: The development phase is 80% complete...
Mike: We need to finalize the testing strategy by Friday...

Action Items:
- John to complete remaining development tasks by Wednesday
- Sarah to schedule testing review meeting
- Mike to prepare test cases document"></textarea>
                                <div class="form-text">
                                    <i class="bi bi-info-circle me-1"></i>
                                    Paste your meeting transcript here. Include speaker names, discussions, and any notes you have.
                                </div>
                            </div>
                        </div>

                        <!-- Upload File Tab -->
                        <div class="tab-pane fade" id="upload-pane" role="tabpanel" aria-labelledby="upload-tab">
                            <div class="mb-4">
                                <label for="transcript_file" class="form-label fw-bold">
                                    <i class="bi bi-file-earmark me-1"></i>Transcript File
                                </label>
                                <input type="file" class="form-control form-control-lg" id="transcript_file" 
                                       name="transcript_file" accept=".txt,.docx">
                                <div class="form-text">
                                    <i class="bi bi-info-circle me-1"></i>
                                    Supported formats: <strong>.txt</strong> (Text files) and <strong>.docx</strong> (Word documents)
                                    <br>Maximum file size: 16MB
                                </div>
                            </div>

                            <!-- File Upload Area -->
                            <div class="border-2 border-dashed border-primary rounded-3 p-4 text-center bg-light">
                                <i class="bi bi-cloud-upload text-primary" style="font-size: 3rem;"></i>
                                <h5 class="text-primary mt-3">Drop your file here or click to browse</h5>
                                <p class="text-muted mb-0">Support for .txt and .docx files</p>
                            </div>
                        </div>
                    </div>

                    <!-- Processing Options -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="extract_action_items" checked>
                                <label class="form-check-label" for="extract_action_items">
                                    <i class="bi bi-check2-square me-1"></i>Extract Action Items
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="identify_decisions" checked>
                                <label class="form-check-label" for="identify_decisions">
                                    <i class="bi bi-lightbulb me-1"></i>Identify Key Decisions
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg" id="processBtn">
                            <i class="bi bi-robot me-2"></i>Generate Meeting Minutes
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Help Section -->
        <div class="mt-5">
            <div class="card border-info">
                <div class="card-header bg-info text-white">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-question-circle me-2"></i>Tips for Best Results
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-info">
                                <i class="bi bi-check-circle me-1"></i>What to Include:
                            </h6>
                            <ul class="small text-muted">
                                <li>Speaker names and dialogue</li>
                                <li>Key discussion points</li>
                                <li>Decisions made during the meeting</li>
                                <li>Any action items mentioned</li>
                                <li>Important dates and deadlines</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-info">
                                <i class="bi bi-lightbulb me-1"></i>Best Practices:
                            </h6>
                            <ul class="small text-muted">
                                <li>Provide detailed, clear transcripts</li>
                                <li>Include context and background information</li>
                                <li>Mention attendee names when possible</li>
                                <li>Use clear formatting for better results</li>
                                <li>Include meeting agenda if available</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('transcriptForm');
    const processBtn = document.getElementById('processBtn');
    const textArea = document.getElementById('transcript_text');
    const fileInput = document.getElementById('transcript_file');
    
    // Form submission handling
    form.addEventListener('submit', function(e) {
        const textContent = textArea.value.trim();
        const fileContent = fileInput.files.length > 0;
        
        if (!textContent && !fileContent) {
            e.preventDefault();
            alert('Please either paste text or upload a file before processing.');
            return;
        }
        
        // Show processing state
        processBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Processing...';
        processBtn.disabled = true;
    });
    
    // File drag and drop functionality
    const uploadArea = document.querySelector('.border-dashed');
    
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, preventDefaults, false);
    });
    
    function preventDefaults(e) {
        e.preventDefault();
        e.stopPropagation();
    }
    
    ['dragenter', 'dragover'].forEach(eventName => {
        uploadArea.addEventListener(eventName, highlight, false);
    });
    
    ['dragleave', 'drop'].forEach(eventName => {
        uploadArea.addEventListener(eventName, unhighlight, false);
    });
    
    function highlight(e) {
        uploadArea.classList.add('bg-primary', 'bg-opacity-10');
    }
    
    function unhighlight(e) {
        uploadArea.classList.remove('bg-primary', 'bg-opacity-10');
    }
    
    uploadArea.addEventListener('drop', handleDrop, false);
    
    function handleDrop(e) {
        const dt = e.dataTransfer;
        const files = dt.files;
        
        if (files.length > 0) {
            fileInput.files = files;
            // Switch to upload tab
            const uploadTab = document.getElementById('upload-tab');
            uploadTab.click();
        }
    }
});
</script>
{% endblock %}